<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Hail 0.2 EXAMPLE-6 on the AWS Cloud</title>
<link rel="stylesheet" href="https://aws-quickstart.s3.us-east-1.amazonaws.com/doc-stylesheets/quickstart-docs.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_overview">Overview</a></li>
<li><a href="#_hail_0_2_example_6_on_aws">Hail 0.2 EXAMPLE-6 on AWS</a></li>
<li><a href="#_cost">Cost</a></li>
<li><a href="#_software_licenses">Software licenses</a></li>
<li><a href="#_architecture">Architecture</a></li>
<li><a href="#_planning_the_deployment">Planning the deployment</a>
<ul class="sectlevel2">
<li><a href="#_specialized_knowledge">Specialized knowledge</a></li>
<li><a href="#_aws_account">AWS account</a></li>
<li><a href="#_technical_requirements">Technical requirements</a></li>
</ul>
</li>
<li><a href="#_deployment_steps">Deployment steps</a>
<ul class="sectlevel2">
<li><a href="#_sign_in_to_your_aws_account">Sign in to your AWS account</a></li>
<li><a href="#_launch_the_quick_start">Launch the Quick Start</a></li>
<li><a href="#_launch_into_a_new_vpc">Launch into a new VPC</a></li>
<li><a href="#_launch_into_an_existing_vpc">Launch into an existing VPC</a></li>
</ul>
</li>
<li><a href="#_post_deployment_steps">Post deployment steps</a>
<ul class="sectlevel2">
<li><a href="#_grant_permissions_to_the_hail_0_2_service_catalog_portfolio">Grant permissions to the Hail 0.2 Service Catalog Portfolio</a></li>
<li><a href="#_launch_a_hail_cluster">Launch a Hail cluster</a></li>
<li><a href="#_launch_a_hail_notebook">Launch a Hail Notebook</a></li>
<li><a href="#_open_the_notebook_connect_to_the_cluster_and_conquer">Open the notebook, connect to the cluster, and conquer</a></li>
</ul>
</li>
<li><a href="#_best_practices_for_using_hail_0_2_example_6_on_aws">Best practices for using Hail 0.2 EXAMPLE-6 on AWS</a></li>
<li><a href="#_faq">FAQ</a></li>
<li><a href="#_send_us_feedback">Send us feedback</a></li>
<li><a href="#_quick_start_reference_deployments">Quick Start reference deployments</a></li>
<li><a href="#_github_repository">GitHub repository</a></li>
<li><a href="#_notices">Notices</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<h2 id="_hail_0_2_example_6_on_the_aws_cloud" class="discrete text-center">Hail 0.2 EXAMPLE-6 on the AWS Cloud</h2>
<h2 id="_quick_start_reference_deployment" class="discrete text-left text-center">Quick Start Reference Deployment</h2>
<div class="imageblock text-center">
<div class="content">
<img src="https://aws-quickstart.s3.amazonaws.com/quickstart-hail/docs/boilerplate/.images/aws-quickstart-graphic.png" alt="QS" width="80" height="80">
</div>
</div>
<div class="paragraph text-center">
<p><strong>March 193rd 2020</strong><br>
<em>Adam Perry, Privo and Adam Tebbe, Goldfinch Pharmaceuticals</em><br>
<em>Paul Underwood, AWS and Roy Hasson, AWS</em></p>
</div>
<div class="admonitionblock tip text-left">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Visit our <a href="https://github.com/aws-quickstart/quickstart-hail" target="_blank" rel="noopener">GitHub repository</a> for source files and to post feedback,
report bugs, or submit feature ideas for this Quick Start.
</td>
</tr>
</table>
</div>
<div class="paragraph text-left">
<p>This Quick Start was created by Privo in collaboration with Amazon Web Services (AWS). <a href="http://aws.amazon.com/quickstart/" target="_blank" rel="noopener">Quick Starts</a> are automated reference deployments that use AWS CloudFormation templates to deploy key technologies on AWS, following AWS best practices.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview">Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This Quick Start is for users who want to use an open-source library for scalable data exploration and analysis, with particular emphasis on genomics.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Amazon may share user-deployment information with the AWS Partner that collaborated with AWS on the Quick Start.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hail_0_2_example_6_on_aws">Hail 0.2 EXAMPLE-6 on AWS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This Quick Start, built in collaboration with Privo, helps to simplify building, managing, and interacting with Hail 0.2 EXAMPLE-6 clusters in your Amazon Web Services (AWS) account. Hail 0.2 EXAMPLE-6 is an open-source library built for Apache Spark to provide scalable data exploration and analysis, with a particular emphasis on genomics.</p>
</div>
<div class="paragraph">
<p>Using Hail 0.2 EXAMPLE-6, researchers can perform genomic analysis more quickly and efficiently. Hail 0.2 EXAMPLE-6 makes it easier to use Spark programming techniques to process genetic data (genomic data frames). It also helps to simplify dealing with multiple input formats by creating a common data structure (Hail MatrixTable).</p>
</div>
<div class="paragraph">
<p>This deployment uses Amazon EMR in combination with Apache Spark to scale large datasets across instances, such as production-scale genome‚Äêwide association studies (GWAS) and single-node ad hoc processes.</p>
</div>
<div class="paragraph">
<p>Hail 0.2 EXAMPLE-6 is maintained by a team in the <a href="https://www.nealelab.is">Neale</a> lab at the <a href="https://www.broadinstitute.org/stanley">Stanley Center for Psychiatric Research</a> of the <a href="https://www.broadinstitute.org/">Broad Institute of MIT and Harvard</a> and the <a href="https://www.atgu.mgh.harvard.edu/">Analytic and Translational Genetics Unit</a> of <a href="https://www.massgeneral.org">Massachusetts General Hospital</a>.
This Quick Start packages Hail 0.2 EXAMPLE-6 into your AWS environment and makes it easy to spin up clusters and integrated Notebooks for analysis.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cost">Cost</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You are responsible for the cost of the AWS services used while running
this Quick Start. There is no additional cost for
using the Quick Start.</p>
</div>
<div class="paragraph">
<p>The AWS CloudFormation templates for Quick Starts include
configuration parameters that you can customize. Some of the settings,
such as the instance type, affect the cost of deployment. For cost estimates,
see the pricing pages for each AWS service you use. Prices are subject to change.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
After you deploy the Quick Start, <a href="https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/billing-reports-gettingstarted-turnonreports.html" target="_blank" rel="noopener">create AWS Cost and Usage Reports</a> to deliver billing metrics to an Amazon Simple Storage Service (Amazon S3) bucket in your account. These reports provide cost estimates based on usage throughout each month and aggregate the data at the end of the month. For more information, see <a href="https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/billing-reports-costusage.html" target="_blank" rel="noopener">What are AWS Cost and Usage Reports?</a>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_software_licenses">Software licenses</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hail 0.2 EXAMPLE-6 is released under the <a href="https://github.com/hail-is/hail/blob/master/LICENSE">MIT License</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture">Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Deploying this Quick Start for a new virtual private cloud (VPC) with
default parameters builds the following Hail 0.2 EXAMPLE-6 environment in the
AWS Cloud.</p>
</div>
<div id="architecture1" class="imageblock">
<div class="content">
<img src="images/hail-architecture-diagram.png" alt="Architecture" width="648" height="439">
</div>
<div class="title">Figure 1. Quick Start architecture for Hail 0.2 EXAMPLE-6 on AWS</div>
</div>
<div class="paragraph">
<p>After the Hail Service Catalog portfolio is deployed, you can spin up notebook instances and Hail 0.2 EXAMPLE-6 clusters that can talk to each other through Sparkmagic and Livy.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/overview.png" alt="Overview" width="648" height="439">
</div>
</div>
<div class="paragraph">
<p>As shown in figure 1, the Quick Start sets up the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A Hail 0.2 EXAMPLE-6 AWS Service Catalog portfolio, allowing you to create and manage your own Hail clusters.</p>
</li>
<li>
<p>Four AWS CodeBuild pipelines to support building various combinations of Hail 0.2.x releases, Variant Effect Predictor (VEP) versions, and Loss-Of-Function Transcript Effect Estimator (LOFTEE) plug-ins.</p>
</li>
<li>
<p>An Amazon SageMaker instance that lets you stand up and tear down JupyterLab notebook environments that integrate with Hail clusters (through Sparkmagic and Livy).</p>
</li>
<li>
<p>An Amazon EMR cluster that lets you stand up and tear down Hail 0.2 EXAMPLE-6 clusters as needed.</p>
</li>
<li>
<p>An Amazon Simple Storage Service (Amazon S3) Sagemaker bucket to back up launched notebook environments.</p>
</li>
<li>
<p>An Amazon S3 bucket for staging Hail artifacts.</p>
</li>
<li>
<p>An optional VPC configured with a private subnet, according to AWS best practices, to provide you with your own virtual network on AWS.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_planning_the_deployment">Planning the deployment</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_specialized_knowledge">Specialized knowledge</h3>
<div class="paragraph">
<p>This deployment guide requires a moderate level of familiarity with
AWS services. If you‚Äôre new to AWS, visit the
<a href="https://aws.amazon.com/getting-started/" target="_blank" rel="noopener">Getting Started Resource Center</a>
and the <a href="https://aws.amazon.com/training/">AWS Training and Certification
website</a>. These sites provide materials for learning how to design,
deploy, and operate your infrastructure and applications on the AWS
Cloud.</p>
</div>
</div>
<div class="sect2">
<h3 id="_aws_account">AWS account</h3>
<div class="paragraph">
<p>If you don‚Äôt already have an AWS account, create one at <a href="https://aws.amazon.com/" target="_blank" rel="noopener">https://aws.amazon.com</a> by following the on-screen instructions. Part of the sign-up process involves receiving a phone call and entering a PIN using the phone keypad.</p>
</div>
<div class="paragraph">
<p>Your AWS account is automatically signed up for all AWS services. You are charged only for the services you use.</p>
</div>
</div>
<div class="sect2">
<h3 id="_technical_requirements">Technical requirements</h3>
<div class="paragraph">
<p>Before you launch the Quick Start, your account must be configured as specified in the following table. Otherwise, deployment might fail.</p>
</div>
<div class="sect3">
<h4 id="_resource_quotas">Resource quotas</h4>
<div class="paragraph">
<p>If necessary, request <a href="https://console.aws.amazon.com/servicequotas/home?region=us-east-2#!/" target="_blank" rel="noopener">service quota increases</a> for the following resources. You might need to request increases if your existing deployment currently uses these resources and if this Quick Start deployment could result in exceeding the default quotas. The <a href="https://console.aws.amazon.com/servicequotas/home?region=us-east-2#!/" target="_blank" rel="noopener">Service Quotas console</a> displays your usage and quotas for some aspects of some services. For more information, see <a href="https://docs.aws.amazon.com/servicequotas/latest/userguide/intro.html" target="_blank" rel="noopener">What is Service Quotas?</a> and <a href="https://docs.aws.amazon.com/general/latest/gr/aws_service_limits.html" target="_blank" rel="noopener">AWS service quotas</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">This deployment uses</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VPCs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elastic IP addresses</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IAM roles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ml.t3.medium instances</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 (per Hail SageMaker notebook)**</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">r5.xlarge, m5.xlarge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 each (per Hail Cluster)**</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>*The VPC is optional. If you don&#8217;t deploy the VPC, these resources aren&#8217;t used.</p>
</div>
<div class="paragraph">
<p>**These are the defaults. You can change instance types for both the Notebook and cluster nodes. You can also specify more nodes in your cluster.</p>
</div>
</div>
<div class="sect3">
<h4 id="_supported_regions">Supported Regions</h4>
<div class="ulist">
<ul>
<li>
<p>us-east-1 (N. Virginia)</p>
</li>
<li>
<p>us-east-2 (Ohio)</p>
</li>
<li>
<p>us-west-1 (N. California)</p>
</li>
<li>
<p>us-west-2 (Oregon)</p>
</li>
<li>
<p>ca-central-1 (Canada Central)</p>
</li>
<li>
<p>eu-central-1 (Frankfurt)</p>
</li>
<li>
<p>eu-west-1 (Ireland)</p>
</li>
<li>
<p>eu-west-2 (London)</p>
</li>
<li>
<p>eu-west-3 (Paris)</p>
</li>
<li>
<p>ap-southeast-1 (Singapore)</p>
</li>
<li>
<p>ap-southeast-2 (Sydney)</p>
</li>
<li>
<p>ap-south-1 (Mumbai)</p>
</li>
<li>
<p>ap-northeast-1 (Tokyo)</p>
</li>
<li>
<p>ap-northeast-2 (Seoul)</p>
</li>
<li>
<p>sa-east-1 (South America)</p>
</li>
<li>
<p>eu-north-1 (Stockholm)</p>
</li>
<li>
<p>ap-east-1 (Hong Kong)</p>
</li>
<li>
<p>me-south-1 (Bahrain)</p>
</li>
<li>
<p>af-south-1 (Cape Town)</p>
</li>
<li>
<p>eu-south-1 (Milan)</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Certain Regions are available on an opt-in basis. See <a href="https://docs.aws.amazon.com/general/latest/gr/rande-manage.html" target="_blank" rel="noopener">Managing AWS Regions</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_ec2_key_pairs">EC2 key pairs</h4>
<div class="paragraph">
<p>Make sure that at least one <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html" target="_blank" rel="noopener">Amazon EC2 key pair</a> exists in your AWS account in the Region where you plan to deploy the Quick Start. Make note of the key pair name. You need it during deployment. To create a key pair, see <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html" target="_blank" rel="noopener">Amazon EC2 key pairs and Linux instances</a>.</p>
</div>
<div class="paragraph">
<p>For testing or proof-of-concept purposes, we recommend creating a new key pair instead of using one that‚Äôs already being used by a production instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_iam_permissions">IAM permissions</h4>
<div class="paragraph">
<p>Before launching the Quick Start, you must sign in to the AWS Management Console with IAM permissions for the resources that the templates deploy. The <em>AdministratorAccess</em> managed policy within IAM provides sufficient permissions, although your organization may choose to use a custom policy with more restrictions. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html" target="_blank" rel="noopener">AWS managed policies for job functions</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_deployment_options">Deployment options</h4>
<div class="paragraph">
<p>This Quick Start provides two deployment options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Deploy Hail 0.2 EXAMPLE-6 into a new VPC (end-to-end deployment)</strong>. This option builds a new AWS environment that includes the VPC, subnets, NAT gateways, security groups, bastion hosts, and other infrastructure components. It then sets a number of AWS Parameter Store values with the appropriate resource IDs for components such as the VPC, subnets, and roles. The parameters are then referenced automatically by the Hail 0.2 EXAMPLE-6 Service Catalog when you deploy Notebooks or clusters.</p>
</li>
<li>
<p><strong>Deploy Hail 0.2 EXAMPLE-6 into an existing VPC</strong>. This option provisions in your existing AWS infrastructure. It sets the necessary AWS Parameter Store values used by the Hail 0.2 EXAMPLE-6 Service Catalog products to the existing resources that you want to use.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Quick Start provides a single template for both options. It also lets you configure Classless Inter-Domain Routing (CIDR) blocks, instance types, Hail, VEP, and Amazon EMR settings, as discussed later in this guide.</p>
</div>
<div class="paragraph">
<p>For details about operations, maintenance, and cluster management, see the <a href="https://fwd.aws/Ww6Yz">readme file</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deployment_steps">Deployment steps</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_sign_in_to_your_aws_account">Sign in to your AWS account</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Sign in to your AWS account at <a href="https://aws.amazon.com" class="bare">https://aws.amazon.com</a> with an Identity and Access Management (IAM) user role that has the necessary permissions. For details, see <a href="#planning-the-deployment">Planning the deployment</a> earlier in this guide.</p>
</li>
<li>
<p>To help confirm that your AWS account is configured correctly, see the <a href="#technical-requirements">Technical requirements</a> section.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_launch_the_quick_start">Launch the Quick Start</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You are responsible for the cost of the AWS services used while running this Quick Start reference deployment. There is no additional cost for using this Quick Start. For full details, see the pricing pages for each AWS service used by this Quick Start. Prices are subject to change.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Sign in to your AWS account, and choose one of the following options to launch the AWS CloudFormation template. For help with choosing an option, see <a href="#_Automated_Deployment">deployment options</a> earlier in this guide.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://fwd.aws/dPJ7W" target="_blank" rel="noopener">Deploy Hail 0.2 EXAMPLE-6 into a new VPC on AWS</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://fwd.aws/dPJ7W" target="_blank" rel="noopener">Deploy Hail 0.2 EXAMPLE-6 into an existing VPC on AWS</a></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If you‚Äôre deploying Hail 0.2 EXAMPLE-6 into an existing VPC, make sure that your VPC has two private subnets in different Availability Zones for the workload instances, and that the subnets aren‚Äôt shared. This Quick Start doesn‚Äôt support <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-sharing.html">shared subnets</a>. These subnets require <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html">NAT gateways</a> in their route tables, to allow the instances to download packages and software without exposing them to the internet.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Also, make sure that the domain name option in the Dynamic Host Configuration Protocol (DHCP) options is configured as explained in the <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_DHCP_Options.html">Amazon VPC documentation</a>. Provide your VPC settings when you launch the Quick Start.</p>
</div>
<div class="paragraph">
<p>Each deployment takes about 10 minutes to complete.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Check the AWS Region that‚Äôs displayed in the upper-right corner of the navigation bar, and change it if necessary. This Region is where the network infrastructure for Hail 0.2 EXAMPLE-6 is built. The template is launched in the us-east-1 Region by default.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>On the <strong>Create stack</strong> page, keep the default setting for the template URL, and then choose <strong>Next</strong>.</p>
</li>
<li>
<p>On the <strong>Specify stack details</strong> page, change the stack name if needed. Review the parameters for the template. Provide values for the parameters that require input. For all other parameters, review the default settings and customize them as necessary.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the following tables, parameters are listed by category and described separately for the deployment options. When you finish reviewing and customizing the parameters, choose <strong>Next</strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Unless you are customizing the Quick Start templates for your own deployment projects, we recommend that you keep the default settings for the parameters labeled <code>Quick Start S3 bucket name</code>, <code>Quick Start S3 bucket
Region</code>, and <code>Quick Start S3 key prefix</code>. Changing these parameter settings automatically updates code references to point to a new Quick Start location. For more information, see the <a href="https://aws-quickstart.github.io/option1.html" target="_blank" rel="noopener">AWS Quick Start Contributor‚Äôs Guide</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_launch_into_a_new_vpc">Launch into a new VPC</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Network Configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VPC target
(<code>VPCTarget</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>existing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Choose "new" to use the AWS VPC Quick Start to create a new VPC with three public and three private subnets. If you choose "existing", VPCId and SubnetId network parameters are required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">New VPC CIDR
(<code>VPCCIDR</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.0.0/16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required for a new VPC. A /16 address space is recommended for a new VPC.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Existing VPC ID
(<code>VPCId</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Blank string</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required for existing VPC target.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Existing subnet ID
(<code>VPCSubnetId</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Blank string</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required for an existing VPC target. Subnet ID in the existing VPC in which EMR Cluster and SageMaker Notebook Instances will be launched. A private subnet is recommended.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Existing subnet type
(<code>VPCSubnetType</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>private</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required for an existing VPC target. Should match the type of subnet specified by Subnet Id. Type of subnet compute resources will be deployed in and also used to create custom AMIs. A private subnet is recommended.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Hail Configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hail S3 bucket name
(<code>HailS3BucketName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the S3 bucket that stores EMR logs, cluster manifests, and VEP configuration files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create Hail S3 bucket
(<code>CreateHailBucket</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>yes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select No to use an existing bucket.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sagemaker home directory S3 bucket name
(<code>SageMakerS3BucketName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the S3 bucket for common notebooks and SageMaker home directory backups.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create SageMaker home directory S3 bucket
(<code>CreateSageMakerBucket</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>yes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select No to use an existing bucket.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EBS KMS Key ARN
(<code>KMSEbsKeyArn</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Blank string</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The full KMS Key ARN if Region level EBS encryption is enabled. This does not automatically encrypt your AMI.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Tagging Configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment type
(<code>TagEnvironmentType</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>development</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment type for default resource tagging.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Owner
(<code>TagOwner</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Blank string</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Owner for default resource tagging. Suggested values are &lt;User Name&gt;, &lt;Department Name&gt;, &lt;Project Name&gt;, etc.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. AWS Quick Start Configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quick Start S3 bucket name
(<code>QSS3BucketName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>aws-quickstart</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S3 bucket name for the Quick Start assets. Quick Start bucket name can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quick Start S3 key prefix
(<code>QSS3KeyPrefix</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quickstart-hail/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S3 key prefix for the Quick Start assets. Quick Start key prefix can include numbers, lowercase letters, uppercase letters, hyphens (-), and forward slash (/).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Region of Quickstart bucket
(<code>QSS3BucketRegion</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>us-east-1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The AWS Region where the Quick Start S3 bucket (QSS3BucketName) is hosted.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_launch_into_an_existing_vpc">Launch into an existing VPC</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. AWS Quick Start Configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quick Start S3 bucket name
(<code>QSS3BucketName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>aws-quickstart</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S3 bucket name for the Quick Start assets. Quick Start bucket name can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quick Start S3 key prefix
(<code>QSS3KeyPrefix</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quickstart-hail/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S3 key prefix for the Quick Start assets. Quick Start key prefix can include numbers, lowercase letters, uppercase letters, hyphens (-), and forward slash (/).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quick Start S3 bucket region
(<code>QSS3BucketRegion</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>us-east-1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The AWS Region where the Quick Start S3 bucket (QSS3BucketName) is hosted. When using your own bucket, you must specify this value.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Network Settings</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Existing VPC ID
(<code>pVpcId</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required - SageMaker security group is created in this VPC.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Existing Subnet ID
(<code>pSubnetId</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required for existing VPC target. Subnet for EMR Cluster and SageMaker Notebook Instances.  Must reside in the existing VPC.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Existing Subnet Type
(<code>pSubnetType</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>private</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required for existing VPC target. Public subnets deploy resources with public IPs.  Private subnets do not.  Private subnets are recommended.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Hail Settings</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hail Bucket Name
(<code>pHailBucket</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMR logs, cluster manifests, and VEP configuration files are placed here.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create Hail Bucket
(<code>pCreateHailBucket</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>yes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select No to use an existing bucket.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sagemaker Home Directory Bucket Name
(<code>pSageMakerBucket</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bucket for common Jupyter notebooks and SageMaker home directory backups.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create SageMaker Bucket
(<code>pCreateSageMakerBucket</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>yes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select No to use an existing bucket.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EBS KMS Key ARN
(<code>pKmsEbsArn</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Blank string</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional - if the source AMI is encrypted specify the full key ARN.  Otherwise, leave blank.  This does NOT automatically enable EBS encryption.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Tagging</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment Tag
(<code>pTagEnvironment</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>development</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment type for default resource tagging.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Owner Tag
(<code>pTagOwner</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Blank string</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional - Owner of the resources.  Person/Department, etc.</p></td>
</tr>
</tbody>
</table>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>On the <strong>Configure stack options</strong> page, you can <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-resource-tags.html" target="_blank" rel="noopener">specify tags</a> (key-value pairs) for resources in your stack and <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-console-add-tags.html" target="_blank" rel="noopener">set advanced options</a>. When you‚Äôre finished, choose <strong>Next</strong>.</p>
</li>
<li>
<p>On the <strong>Review</strong> page, review and confirm the template settings. Under <strong>Capabilities</strong>, select the two check boxes to acknowledge that the template creates IAM resources and might require the ability to automatically expand macros.</p>
</li>
<li>
<p>Choose <strong>Create stack</strong> to deploy the stack.</p>
</li>
<li>
<p>Monitor the status of the stack. When the status is <strong>CREATE_COMPLETE</strong>, the Hail 0.2 EXAMPLE-6 deployment is ready.</p>
</li>
<li>
<p>Use the values displayed in the <strong>Outputs</strong> tab for the stack, as shown in <a href="#cfn_outputs">Hail 0.2 EXAMPLE-6 outputs after successful deployment</a>, to view the created resources.</p>
</li>
</ol>
</div>
<div id="cfn_outputs" class="imageblock">
<div class="content">
<a class="image" href="images/cfn_outputs.png"><img src="images/cfn_outputs.png" alt="cfn_outputs" width="648" height="439"></a>
</div>
<div class="title">Figure 2. Hail 0.2 EXAMPLE-6 outputs after successful deployment</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_post_deployment_steps">Post deployment steps</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_grant_permissions_to_the_hail_0_2_service_catalog_portfolio">Grant permissions to the Hail 0.2 Service Catalog Portfolio</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the AWS Service Catalog console and choose the <strong>Hail Products</strong> portfolio.</p>
</li>
<li>
<p>Choose the <strong>Groups, roles, and users (1)</strong> tab, and then choose the <strong>Add groups, roles, users</strong> button.</p>
</li>
<li>
<p>Choose the IAM users/roles/groups that you want to grant the ability to launch Hail 0.2 EXAMPLE-6 clusters or notebooks. For example, if you are giving access to an IAM user, even though you launched the catalog, you still must explicitly grant yourself permissions this way. Don‚Äôt forget to grant yourself access.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_launch_a_hail_cluster">Launch a Hail cluster</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Return to the Service Catalog and choose the <strong>Products</strong> link at the top on the left gutter. Non-administrators who visit the Service Catalog in the console are taken directly to this location.</p>
</li>
<li>
<p>Select the stacked dots on the Hail 0.2 EXAMPLE-6 EMR Cluster product and choose <strong>Launch Product</strong>.</p>
</li>
<li>
<p>Provide a name for the Hail 0.2 EXAMPLE-6 cluster and choose <strong>Next</strong> to see the following Hail 0.2 EXAMPLE-6 cluster options.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Cluster Primary Settings</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cluster Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>Requires input</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the EMR cluster</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hail AMI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">''</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) Custom AMI, specific version from the public AMI list, or empty value.  If empty, the latest public Hail with VEP AMI is used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMR Release</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">emr-5.29.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AWS EMR release version to use for cluster nodes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Root Volume Size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Root volume size in GB for all cluster instances.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EBS KMS Key ARN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">''</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) The full KMS Key ARN if region level EBS encryption is enabled. Note, this does NOT automatically encrypt your AMI.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instance Termination Protection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Choose <strong>True</strong> to enable instance termination protection on Master and Core nodes of the cluster.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allow SSM Shell Access from SageMaker Notebook Instances</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Choose <strong>True</strong> to allow SSM Shell access to cluster nodes from SageMaker Notebook instances. To fully enable the setting, select <strong>True</strong> when creating SageMaker notebook instances.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Master Instance Settings</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Master Node Size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">m5.xlarge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instance type to use for EMR master node</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. Core Instance Settings</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of Core Nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of core nodes to launch with the cluster. Must be &gt;= 1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Instance Size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">r5.xlarge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instanct type to use for EMR core nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scratch Volume Size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secondary GP2 data volume size in GB for CORE nodes. Available on /mnt</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Auto Scaling Task Node Settings</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Market</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ON_DEMAND</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select ‚ÄúSPOT‚Äù to use Spot instances for Task nodes. Spot instances are used with a max bid of the on demand price.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minimum number of Task Nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of 0 disables task nodes and auto scaling.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of Task Nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Must be equal to or greater than minimum.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task Node Size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">r5.large</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instance type to use for EMR task nodes</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Tagging</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment Tag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">development</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment type for default resource tagging.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Owner Tag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">''</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) - Owner of the resources. Person/Department, etc.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Proceed through the Service Catalog wizard, accepting default values for the <strong>Tag Options</strong>, <strong>Notifications</strong>, and <strong>Review</strong> phases of the wizard. Then choose <strong>Launch</strong>.</p>
</div>
<div class="paragraph">
<p>The cluster is provisioned, and the status changes to suceeded when complete.</p>
</div>
</div>
<div class="sect2">
<h3 id="_launch_a_hail_notebook">Launch a Hail Notebook</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go back to the Service Catalog‚Äôs product list page, choose <strong>Hail SageMaker Notebook Instance</strong> &gt; <strong>Launch product</strong>.</p>
</li>
<li>
<p>Provide a name for your Service Catalog product launch in the <strong>Product version</strong> phase of the launch wizard.</p>
</li>
<li>
<p>Supply the following parameters when you reach the <strong>Parameters</strong> phase.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. Instance Details</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instance Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>Requires input</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used as the name of the notebook instance and S3 backup location. User name is recommended - E.g. jsmith</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instance Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ml.t3.medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instance type to use for the notebook instance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Volume Size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size in GB of the EBS volume used by the notebook instance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allow SSM Shell Access to EMR Nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Choose <strong>True</strong> to allow SSM Shell access to cluster nodes from SageMaker notebook instances. To be fully enabled, set this setting to <strong>True</strong> when creating an EMR cluster.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. Tagging</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment Tag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">development</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment type for default resource tagging.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Owner Tag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">''</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) - Owner of the resources. Person/Department, etc.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Proceed through the <strong>Tag Options</strong>, <strong>Notificatons</strong>, and <strong>Review</strong> phases of the wizard, accept the default settings, and choose <strong>Launch</strong> to complete the Notebook.</p>
</div>
</div>
<div class="sect2">
<h3 id="_open_the_notebook_connect_to_the_cluster_and_conquer">Open the notebook, connect to the cluster, and conquer</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to SageMaker in the web console, and choose <strong>Notebook instances</strong> in the left gutter. You will see a notebook instance with the <strong>name</strong> tag you specified when you launched the notebook from the Service Catalog.</p>
</li>
<li>
<p>Choose that notebook instance and then choose the <strong>Open JupyterLab</strong> hyperlink.</p>
<div class="ulist">
<ul>
<li>
<p>After the notebook launches, navigate to the <strong>common-notebooks</strong> folder to see example notebooks that show how to connect to the EMR cluster and begin your Hail 0.2 EXAMPLE-6 session.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_best_practices_for_using_hail_0_2_example_6_on_aws">Best practices for using Hail 0.2 EXAMPLE-6 on AWS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Although you can work with Hail on EMR through the notebook, you might simply want to access and explore the hosts. If you need to access the hosts, make sure you set <strong>Allow SSM Shell Access to EMR Nodes</strong> to true when you launch the cluster through the Service Catalog.</p>
</div>
<div class="paragraph">
<p>You can then start SSH sessions on those nodes by using the Start Session feature in AWS Systems Manager Session Manager console. You can also start a session from your local machine using the AWS Command Line Interface (AWS CLI) or a notebook‚Äôs JupyterLab console, as demonstrated below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ssh.png" alt="SSH" width="648" height="439">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_faq">FAQ</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Q.</strong> I encountered a <strong>CREATE_FAILED</strong> error when I launched the Quick Start.</p>
</div>
<div class="paragraph">
<p><strong>A.</strong> If AWS CloudFormation fails to create the stack, relaunch the template with the <strong>Rollback on failure</strong> set to <strong>No</strong>. (This setting is on the <strong>Options</strong> page under <strong>Advanced</strong> in the AWS CloudFormation console.) With this setting, the stack‚Äôs state is retained and the instance is left running, so you can troubleshoot the issue. (For Windows, look at the log files in %ProgramFiles%\Amazon\EC2ConfigService and C:\cfn\log.)</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
When you set <strong>Rollback on failure</strong> to <strong>Disabled</strong>, you continue to incur AWS charges for this stack. Make sure to delete the stack when you finish troubleshooting.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For additional information, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/troubleshooting.html">Troubleshooting AWS CloudFormation</a> on the AWS website.</p>
</div>
<div class="paragraph">
<p><strong>Q.</strong> I encountered a size limitation error when I deployed the AWS CloudFormation templates.</p>
</div>
<div class="paragraph">
<p><strong>A.</strong> Launch the Quick Start templates from the links in this guide or from another S3 bucket. If you deploy the templates from a local copy on your computer or from a location other than an S3 bucket, you might encounter template size limitations. For more information about AWS CloudFormation quotas, see the <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cloudformation-limits.html">AWS documentation</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_send_us_feedback">Send us feedback</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To post feedback, submit feature ideas, or report bugs, use the <strong>Issues</strong> section of the <a href="https://github.com/aws-quickstart/quickstart-hail" target="_blank" rel="noopener">GitHub repository</a> for this Quick Start. To submit code, see the <a href="https://aws-quickstart.github.io/" target="_blank" rel="noopener">Quick Start Contributor‚Äôs Guide</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_quick_start_reference_deployments">Quick Start reference deployments</h2>
<div class="sectionbody">
<div class="paragraph">
<p>See the <a href="https://aws.amazon.com/quickstart/">AWS Quick Start home page</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_github_repository">GitHub repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Visit our <a href="https://github.com/aws-quickstart/quickstart-hail" target="_blank" rel="noopener">GitHub repository</a> to download
the templates and scripts for this Quick Start, to post your comments,
and to share your customizations with others.</p>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_notices">Notices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document is provided for informational purposes only. It represents AWS‚Äôs current product offerings and practices as of the date of issue of this document, which are subject to change without notice. Customers are responsible for making their own independent assessment of the information in this document and any use of AWS‚Äôs products or services, each of which is provided ‚Äúas is‚Äù without warranty of any kind, whether expressed or implied. This document does not create any warranties, representations, contractual commitments, conditions, or assurances from AWS, its affiliates, suppliers, or licensors. The responsibilities and liabilities of AWS to its customers are controlled by AWS agreements, and this document is not part of, nor does it modify, any agreement between AWS and its customers.</p>
</div>
<div class="paragraph">
<p>The software included with this paper is licensed under the Apache License, version 2.0 (the "License"). You may not use this file except in compliance with the License. A copy of the License is located at <a href="http://aws.amazon.com/apache2.0/" class="bare">http://aws.amazon.com/apache2.0/</a> or in the accompanying "license" file. This code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either expressed or implied. See the License for specific language governing permissions and limitations.</p>
</div>
</div>
</div>
</div>
<p class="footer-text">
<!-- We can use document attributes: -->
<!-- Generated with Asciidoctor v2.0.10. -->
<a href="https://aws.amazon.com/privacy/">Privacy</a> | <a href="https://aws.amazon.com/terms/">Site terms</a> | &copy; 2020, Amazon Web Services, Inc. or its affiliates and Privo. All rights reserved.
</p>
</body>
</html>